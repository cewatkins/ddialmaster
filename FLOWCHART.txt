===============================================================================
                    DIVERSI-DIAL MASTER SYSTEM FLOWCHART
===============================================================================
                          Apple //e Hardware Architecture
                    7 Hayes Micromodem //e + 1 Console Channel
                        Real-time Multi-user BBS Operation

                               ┌─────────────┐
                               │   RESET     │
                               │  ($FFFC)    │
                               │  Vector     │
                               └──────┬──────┘
                                      │
                                      ▼
                               ┌─────────────┐
                               │INIT ROUTINE │
                               │  ($1800)    │
                               │CPU Setup    │
                               └──────┬──────┘
                                      │
                         ┌────────────┴────────────┐
                         ▼                         ▼
                  ┌─────────────┐           ┌─────────────┐
                  │SET STACK    │           │CLEAR SCREEN │
                  │PTR ($01FF)  │           │ ($0400)     │
                  │TXS          │           │Text Memory  │
                  └──────┬──────┘           └──────┬──────┘
                         │                         │
                         └────────────┬────────────┘
                                      ▼
                               ┌─────────────┐
                               │INIT SYSTEM  │
                               │VARIABLES    │
                               │Zero Page    │
                               │($18E3-$18F8)│
                               └──────┬──────┘
                                      │
                                      ▼
                               ┌─────────────┐
                               │SETUP 8      │
                               │CHANNELS     │
                               │Buffer Ptrs  │
                               │($C0-$C7)    │
                               └──────┬──────┘
                                      │
                                      ▼
                               ┌─────────────┐
                               │INIT HARDWARE│
                               │ACIA Setup   │
                               │Modem Config │
                               │($1853-$1897)│
                               └──────┬──────┘
                                      │
                                      ▼
                        ┌─────────────────────────┐
                        │    MAIN PROGRAM LOOP    │
                        │       ($28B4)          │
                        │   Real-time Polling    │
                        └───────────┬─────────────┘
                                    │
                                    ▼
                        ┌─────────────────────────┐
                        │   CHECK SYSTEM FLAGS    │
                        │     ($28B6-$28BF)      │
                        │   Status Display       │
                        └───────────┬─────────────┘
                                    │
                                    ▼
                        ┌─────────────────────────┐
                        │  CALL SYSTEM UPDATE     │
                        │    JSR $7FD3           │
                        │  Time/Counter Mgmt     │
                        └───────────┬─────────────┘
                                    │
                                    ▼
                        ┌─────────────────────────┐
                        │   CHECK INPUT BUFFER    │
                        │      LDA $A0           │
                        │   Multi-channel        │
                        └───────────┬─────────────┘
                                    │
                     ┌──────────────┴──────────────┐
                     ▼                             ▼
          ┌─────────────────┐                ┌─────────────────┐
          │   BUFFER EMPTY  │                │  BUFFER HAS     │
          │   ($2919)       │                │     DATA        │
          │ Check Keyboard  │                │ Process Input   │
          └─────────┬───────┘                └─────────┬───────┘
                    │                                  │
                    ▼                                  ▼
          ┌─────────────────┐                ┌─────────────────┐
          │ KEYBOARD CHECK  │                │  INPUT ROUTER   │
          │   ($C000)       │                │   ($28CF-$28F3) │
          │ Apple //e KBD   │                │ Channel Select  │
          └─────────┬───────┘                └─────────┬───────┘
                    │                                  │
                    └─────────────┬────────────────────┘
                                  ▼
                        ┌─────────────────────────┐
                        │     SERIAL I/O          │
                        │    PROCESSING           │
                        │  ($1853-$1897)         │
                        │ ACIA Communication     │
                        └───────────┬─────────────┘
                                    │
                     ┌──────────────┴──────────────┐
                     ▼                             ▼
          ┌─────────────────┐                ┌─────────────────┐
          │  ACIA STATUS    │                │  CHARACTER      │
          │    CHECK        │                │   RECEIVED      │
          │   ($9001)       │                │   ($1862)       │
          │ Hayes/SSC Port  │                │ Data Ready      │
          └─────────┬───────┘                └─────────┬───────┘
                    │                                  │
                    ▼                                  ▼
          ┌─────────────────┐                ┌─────────────────┐
          │   NO DATA       │                │    COMMAND      │
          │   RETURN        │                │   PROCESSING    │
          │ Poll Next Chan  │                │   ($1867-$1887) │
          └─────────────────┘                └─────────┬───────┘
                                                       │
                                                       ▼
                                            ┌─────────────────┐
                                            │  PARSE COMMAND  │
                                            │    ($224A)      │
                                            │ Channel Router  │
                                            └─────────┬───────┘
                                                      │
                                                      ▼
                                            ┌─────────────────┐
                                            │  CHECK COMMAND  │
                                            │   PREFIX (/)    │
                                            │ Validate Format │
                                            └─────────┬───────┘
                                                      │
                                       ┌──────────────┴──────────────┐
                                       ▼                             ▼
                            ┌─────────────────┐                ┌─────────────────┐
                            │ INVALID COMMAND │                │ VALID COMMAND   │
                            │     EXIT        │                │   CONTINUE      │
                            │ Error Response  │                │ Execute Action  │
                            └─────────────────┘                └─────────┬───────┘
                                                                         │
                                                                         ▼
                                                              ┌─────────────────┐
                                                              │ EXTRACT CHANNEL │
                                                              │   NUMBER (0-9)  │
                                                              └─────────┬───────┘
                                                                        │
                                                         ┌──────────────┴──────────────┐
                                                         ▼                             ▼
                                              ┌─────────────────┐                ┌─────────────────┐
                                              │ INVALID CHANNEL │                │ VALID CHANNEL   │
                                              │   (>7 or 0)     │                │    (1-7)        │
                                              └─────────────────┘                └─────────┬───────┘
                                                                                           │
                                                                                           ▼
                                                                                ┌─────────────────┐
                                                                                │ EXTRACT COMMAND │
                                                                                │    CHARACTER    │
                                                                                └─────────┬───────┘
                                                                                          │
                                          ┌───────────────────────────────────────────────┴───────────────────────────────────────────────┐
                                          ▼                             ▼                             ▼                             ▼
                                ┌─────────────────┐           ┌─────────────────┐           ┌─────────────────┐           ┌─────────────────┐
                                │  'M' COMMAND    │           │  'O' COMMAND    │           │  'A' COMMAND    │           │  'L' COMMAND    │
                                │   Message/      │           │   Open/         │           │    Answer       │           │   Line/Link     │
                                │     Mode        │           │   Online        │           │                 │           │                 │
                                │   ($2302)       │           │   ($22E5)       │           │   ($22E9)       │           │   ($22ED)       │
                                └─────────┬───────┘           └─────────┬───────┘           └─────────┬───────┘           └─────────┬───────┘
                                          │                             │                             │                             │
                                          │                             ▼                             ▼                             ▼
                                          │                   ┌─────────────────┐           ┌─────────────────┐           ┌─────────────────┐
                                          │                   │  OPEN CHANNEL   │           │ ANSWER INCOMING │           │  CHECK LINE     │
                                          │                   │   FOR COMM      │           │   CONNECTION    │           │    STATUS       │
                                          │                   └─────────────────┘           └─────────────────┘           └─────────┬───────┘
                                          │                                                                                           │
                                          │                                                                                           ▼
                                          │                                                                                 ┌─────────────────┐
                                          │                                                                                 │ MANAGE LINE     │
                                          │                                                                                 │   CONNECTION    │
                                          │                                                                                 └─────────┬───────┘
                                          │                                                                                           │
                                          └─────────────┬─────────────┬─────────────────────────────────────────────────────────────┘
                                                        ▼             ▼
                                              ┌─────────────────┐           ┌─────────────────┐
                                              │  'F' COMMAND    │           │  'B' COMMAND    │
                                              │   Flip/Flag     │           │  Break/Busy     │
                                              │   ($2322)       │           │   ($2326)       │
                                              └─────────┬───────┘           └─────────┬───────┘
                                                        │                             │
                                                        ▼                             ▼
                                              ┌─────────────────┐           ┌─────────────────┐
                                              │  TOGGLE CHANNEL │           │  SET CHANNEL    │
                                              │     FLAGS       │           │   TO BUSY       │
                                              └─────────┬───────┘           └─────────┬───────┘
                                                        │                             │
                                          ┌─────────────┴─────────────┬───────────────┘
                                          ▼                           ▼
                                ┌─────────────────┐           ┌─────────────────┐
                                │  'E' COMMAND    │           │  'X' COMMAND    │
                                │   End/Exit      │           │   eXchange      │
                                │   ($232A)       │           │   ($232E)       │
                                └─────────┬───────┘           └─────────┬───────┘
                                          │                             │
                                          ▼                             ▼
                                ┌─────────────────┐           ┌─────────────────┐
                                │ END CHANNEL     │           │  EXCHANGE DATA  │
                                │   SESSION       │           │  BETWEEN CHANS  │
                                └─────────┬───────┘           └─────────┬───────┘
                                          │                             │
                                          └─────────────┬───────────────┘
                                                        ▼
                                              ┌─────────────────┐
                                              │  'C' COMMAND    │
                                              │   Connect/      │
                                              │   Channel       │
                                              │   ($2332)       │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │ CONNECT TO      │
                                              │ SPECIFIC CHAN   │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │  'T' COMMAND    │
                                              │  Terminal/Talk  │
                                              │   ($2336)       │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │ ENTER TERMINAL  │
                                              │     MODE        │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │ UPDATE CHANNEL  │
                                              │     STATUS      │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │ CALL CHANNEL    │
                                              │ UPDATE ROUTINE  │
                                              │  JSR $7F98      │
                                              └─────────┬───────┘
                                                        │
                                                        ▼
                                              ┌─────────────────┐
                                              │ RETURN TO MAIN  │
                                              │     LOOP        │
                                              │   ($2A24)       │
                                              └─────────┬───────┘
                                                        │
                                                        └─────────────────────┐
                                                                              │
                                                                              ▼
                                                                    ┌─────────────────┐
                                                                    │ CONTINUE MAIN   │
                                                                    │     LOOP        │
                                                                    │   ($2A24)       │
                                                                    └─────────┬───────┘
                                                                              │
                                                                              └──────────┐
                                                                                         │
                                                                                         ▼
                                                                               ┌─────────────────┐
                                                                               │ SYSTEM UPDATE   │
                                                                               │ AND DISPLAY     │
                                                                               │   MANAGEMENT    │
                                                                               └─────────┬───────┘
                                                                                         │
                                                                                         ▼
                                                                               ┌─────────────────┐
                                                                               │ CHECK FOR MORE  │
                                                                               │     INPUT       │
                                                                               └─────────┬───────┘
                                                                                         │
                                                                                         └───────────┐
                                                                                                     │
                                                                              ┌──────────────────────┘
                                                                              │
                                                                              ▼
                                                                    ┌─────────────────┐
                                                                    │ JUMP BACK TO    │
                                                                    │   MAIN LOOP     │
                                                                    │   ($28B4)       │
                                                                    └─────────┬───────┘
                                                                              │
                                                                              └─┐
                                                                                │
                                     ┌──────────────────────────────────────────┘
                                     │
                                     └──► INFINITE LOOP - SYSTEM RUNS CONTINUOUSLY


===============================================================================
                                LEGEND
===============================================================================

┌─────────┐   Process/Function Block
│         │   
└─────────┘   

    ▼         Flow Direction (Down)
    
    ───►      Flow Direction (Right/Left)
    
($XXXX)       Memory Address Reference

JSR $XXXX     Jump to Subroutine at Address

===============================================================================
                              KEY ADDRESSES
===============================================================================
                          APPLE //E HARDWARE MAP
===============================================================================

MEMORY LAYOUT:
$0000-$00FF   Zero Page Variables (fast access)
  $C0-$C7     Channel buffer pointers (8 channels)
  $D0-$D7     Channel status flags
  $E0-$E7     User authentication state
  $F0-$F7     Session timing and management

$0100-$01FF   6502 Processor Stack
$0400-$07FF   Apple //e Text Screen Memory (40x24)
  $0400-$047F Line 1 (system status display)
  $0480-$04FF Line 2 (channel/user display)
  
$0800-$08FF   Input Buffer (256 bytes)
$1800-$2000   Program Initialization
$2000-$4000   Main Program Code
$4000-$6000   User Database and Buffers
$6000-$8000   Email Storage System (64K)
$8000-$9000   Command Processing Tables
$9000-$9600   System Variables and Status

APPLE //E I/O REGISTERS:
$C000 KBD     Keyboard Data (bit 7 = key pressed)
$C010 KBDSTRB Keyboard Strobe (read to acknowledge)
$C030 SPKR    Speaker Toggle (audio feedback)
$C050-$C057   Video Mode Control (text/graphics)
$C080-$C08F   Language Card Bank Switching

PERIPHERAL SLOTS (Hayes Micromodem //e):
Slot 1: $C090-$C09F (Line 1)
  $C095 RING  Ring Indicator
  $C096 STATUS ACIA Status Register  
  $C097 DATA  ACIA Data Register

Slot 2: $C0A0-$C0AF (Line 2)
Slot 3: $C0B0-$C0BF (Line 3)
Slot 4: $C0C0-$C0CF (Line 4)
Slot 5: $C0D0-$C0DF (Line 5)
Slot 6: $C0E0-$C0EF (Line 6)
Slot 7: $C0F0-$C0FF (Line 7)

ACIA STATUS REGISTER BITS:
Bit 3: RDRF (Receive Data Register Full)
Bit 4: TDRE (Transmit Data Register Empty)  
Bit 7: IRQ (Interrupt Request)

===============================================================================
                            KEY ADDRESSES
===============================================================================

$1800         Main initialization entry point
$1853-$1897   Serial communication handlers  
$189A         System initialization subroutine
$2000         System reset vector
$224A         Command processing entry
$28B4         Main program loop
$2A24         Main loop continuation point
$3ACB         Output routine
$6002         Channel output routine
$7F98         Channel update routine
$7FD3         System update routine
$9001         UART data register

===============================================================================
                            SYSTEM OVERVIEW
===============================================================================

Diversi-DIAL Master operates as a sophisticated multi-line BBS system:

1. BOOT & INITIALIZATION:
   - 4-minute cassette load into Apple //e (64K required)
   - Initialize 8 channels (7 modems + 1 console operator)
   - Setup ACIA registers for Hayes Micromodem //e communication
   - Clear 80-column screen, setup email system (requires 80-col card)
   - Initialize version display, system counters, memory layout

2. REAL-TIME HARDWARE POLLING:
   - Round-robin polling of ACIA status registers ($C096, $C0A6, etc.)
   - Interrupt-driven serial communication with IRQ handling
   - Keyboard monitoring via $C000 (Apple //e KBD register)
   - Memory banking for user data and email storage
   - Text screen updates for real-time status display

3. COMMAND PROCESSING:
   - Parse "/" commands with three access levels:
     * USER: Basic chat, email, info (/H, /C, /P, /E, /W, /Q)
     * PASSWORD: User management, logs (/A, /D, /L, /K, /LG, /X)
     * MASTER: Full system control (/DEBUG, /TRACE, /LINK, /BACKUP)
   - Route commands to appropriate handlers
   - Validate user permissions before execution

4. MULTI-CHANNEL COMMUNICATION:
   - 4 chat channels with independent user groups
   - Real-time message broadcasting within channels
   - Private messaging between any users (/P command)
   - Channel joining/switching (/J command)
   - ACIA-based modem communication at 300-1200 baud

5. ADVANCED FEATURES:
   - Built-in email with user accounts and 64K storage
   - Station linking for multi-BBS networks via phone/parallel
   - Three-tier access control with sophisticated passwords
   - System logging with security auditing
   - Real-time user monitoring and administrative control
   - Automatic time management and resource allocation

6. HARDWARE REQUIREMENTS:
   - Apple //e with 64K RAM and 80-column card
   - 1-7 Hayes Micromodem //e cards in peripheral slots
   - Dedicated phone lines with hunt group capability
   - Cassette tape drive for program loading (4 minutes)
   - Optional parallel cards for station linking

The system represents advanced BBS technology for 1985, providing professional
multi-line operation with sophisticated real-time user management on Apple //e
hardware architecture.
   - Message composition, reading, deletion
   - Requires 80-column card for full functionality

6. NETWORK FEATURES:
   - Station linking via phone lines or direct connection
   - PC Pursuit integration for long-distance linking
   - Multi-station user management and message routing
   - Support for unlimited network expansion

7. SYSTEM MANAGEMENT:
   - Real-time user monitoring and control
   - Automatic call counting and time enforcement
   - System logs with security auditing
   - Backup and restore capabilities
   - Modem configuration and troubleshooting tools

The system supports up to 7 simultaneous dial-up users plus console operator,
with sophisticated real-time management suitable for professional BBS operation.
Commercial license: $475 for first 7 lines, designed for Apple //e platform.

===============================================================================